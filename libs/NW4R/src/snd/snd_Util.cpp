#include <nw4r/snd/Util.h>

#include <nw4r/math.h>
#include <nw4r/ut.h>

namespace nw4r {
    namespace snd {
        namespace detail {
            f32 Util::CalcPitchRatio(int pitch) {
                int octave = 0;
                f32 octaveFloat = 1.0f;

                while (pitch < 0) {
                    octave--;
                    pitch += SEMITONE_MAX * MICROTONE_MAX;
                }

                while (pitch >= SEMITONE_MAX * MICROTONE_MAX) {
                    octave++;
                    pitch -= SEMITONE_MAX * MICROTONE_MAX;
                }

                while (octave > 0) {
                    octaveFloat *= 2.0f;
                    octave--;
                }

                while (octave < 0) {
                    octaveFloat /= 2.0f;
                    octave++;
                }

                int note = pitch / MICROTONE_MAX;
                pitch %= MICROTONE_MAX;

                f32 ratio = octaveFloat;

                if (note != 0) {
                    ratio *= NoteTable[note];
                }
                if (pitch != 0) {
                    ratio *= PitchTable[pitch];
                }

                return ratio;
            }

            f32 Util::CalcVolumeRatio(f32 db) {
                db = ut::Clamp(db, VOLUME_MIN_DB, VOLUME_MAX_DB);
                return Decibel2RatioTable[-VOLUME_MIN + static_cast<int>(10 * db)];
            }

            f32 Util::CalcPanRatio(f32 pan) {
                pan = (ut::Clamp(pan, -1.0f, 1.0f) + 1.0f) / 2.0f;
                return Pan2RatioTable[static_cast<int>(pan * PAN_TABLE_MAX + 0.5f)];
            }

            f32 Util::CalcSurroundPanRatio(f32 surroundPan) {
                surroundPan = ut::Clamp(surroundPan, 0.0f, 2.0f) / 2.0f;
                return Pan2RatioTable[static_cast<int>(surroundPan * PAN_TABLE_MAX + 0.5f)];
            }

            int Util::CalcLpfFreq(f32 scale) {
                scale = ut::Clamp(scale, 0.0f, 1.0f);
                return static_cast<int>(32000 * pow(2.0, 10.0 * (scale - 1.0)));
            }

            u16 Util::CalcRandom() {
                static int u = 0x12345678;
                u = u * 0x19660D + 0x3C6EF35F; // randq1 :D
                return u >> 16;
            }

            const void* Util::GetDataRefAddressImpl(RefType type, u32 value, const void* base) {
                if (type == REFTYPE_OFFSET) {
                    return ut::AddOffsetToPtr(base, Util::ReadBigEndian(value));
                }

                if (type == REFTYPE_ADDRESS) {
                    return reinterpret_cast<void*>(Util::ReadBigEndian(value));
                }

                return NULL;
            }

            const f32 Util::NoteTable[SEMITONE_MAX] = {
                1.0000000f, 1.0594631f, 1.1224620f, 1.1892071f, 1.2599211f, 1.3348398f,
                1.4142135f, 1.4983071f, 1.5874010f, 1.6817929f, 1.7817974f, 1.8877486f};

            const f32 Util::PitchTable[MICROTONE_MAX] = {
                1.00000000f, 1.00022566f, 1.00045133f, 1.00067711f, 1.00090289f,
                1.00112879f, 1.00135469f, 1.00158072f, 1.00180674f, 1.00203276f,
                1.00225890f, 1.00248504f, 1.00271130f, 1.00293756f, 1.00316381f,
                1.00339019f, 1.00361669f, 1.00384319f, 1.00406969f, 1.00429630f,
                1.00452292f, 1.00474954f, 1.00497627f, 1.00520301f, 1.00542986f,
                1.00565684f, 1.00588369f, 1.00611067f, 1.00633776f, 1.00656486f,
                1.00679195f, 1.00701916f, 1.00724638f, 1.00747371f, 1.00770104f,
                1.00792849f, 1.00815594f, 1.00838339f, 1.00861096f, 1.00883853f,
                1.00906622f, 1.00929391f, 1.00952172f, 1.00974953f, 1.00997734f,
                1.01020527f, 1.01043320f, 1.01066124f, 1.01088929f, 1.01111746f,
                1.01134562f, 1.01157379f, 1.01180208f, 1.01203036f, 1.01225877f,
                1.01248717f, 1.01271570f, 1.01294422f, 1.01317275f, 1.01340139f,
                1.01363003f, 1.01385880f, 1.01408756f, 1.01431644f, 1.01454532f,
                1.01477432f, 1.01500332f, 1.01523232f, 1.01546144f, 1.01569057f,
                1.01591980f, 1.01614904f, 1.01637828f, 1.01660764f, 1.01683712f,
                1.01706648f, 1.01729608f, 1.01752555f, 1.01775527f, 1.01798487f,
                1.01821458f, 1.01844442f, 1.01867425f, 1.01890409f, 1.01913404f,
                1.01936400f, 1.01959395f, 1.01982403f, 1.02005422f, 1.02028441f,
                1.02051461f, 1.02074492f, 1.02097523f, 1.02120566f, 1.02143610f,
                1.02166665f, 1.02189720f, 1.02212775f, 1.02235842f, 1.02258909f,
                1.02281988f, 1.02305067f, 1.02328157f, 1.02351248f, 1.02374339f,
                1.02397442f, 1.02420545f, 1.02443659f, 1.02466774f, 1.02489901f,
                1.02513027f, 1.02536166f, 1.02559304f, 1.02582443f, 1.02605593f,
                1.02628744f, 1.02651906f, 1.02675068f, 1.02698243f, 1.02721417f,
                1.02744591f, 1.02767777f, 1.02790976f, 1.02814162f, 1.02837372f,
                1.02860570f, 1.02883780f, 1.02907002f, 1.02930224f, 1.02953446f,
                1.02976680f, 1.02999926f, 1.03023160f, 1.03046417f, 1.03069663f,
                1.03092921f, 1.03116190f, 1.03139460f, 1.03162730f, 1.03186011f,
                1.03209293f, 1.03232586f, 1.03255880f, 1.03279185f, 1.03302491f,
                1.03325796f, 1.03349113f, 1.03372443f, 1.03395760f, 1.03419101f,
                1.03442430f, 1.03465772f, 1.03489125f, 1.03512478f, 1.03535831f,
                1.03559196f, 1.03582573f, 1.03605938f, 1.03629327f, 1.03652704f,
                1.03676093f, 1.03699493f, 1.03722894f, 1.03746295f, 1.03769708f,
                1.03793132f, 1.03816545f, 1.03839982f, 1.03863406f, 1.03886843f,
                1.03910291f, 1.03933740f, 1.03957188f, 1.03980649f, 1.04004121f,
                1.04027581f, 1.04051065f, 1.04074538f, 1.04098022f, 1.04121518f,
                1.04145014f, 1.04168510f, 1.04192019f, 1.04215527f, 1.04239047f,
                1.04262567f, 1.04286098f, 1.04309630f, 1.04333174f, 1.04356718f,
                1.04380262f, 1.04403818f, 1.04427373f, 1.04450941f, 1.04474509f,
                1.04498088f, 1.04521668f, 1.04545259f, 1.04568851f, 1.04592443f,
                1.04616046f, 1.04639649f, 1.04663265f, 1.04686880f, 1.04710507f,
                1.04734135f, 1.04757774f, 1.04781413f, 1.04805052f, 1.04828703f,
                1.04852366f, 1.04876029f, 1.04899693f, 1.04923368f, 1.04947042f,
                1.04970717f, 1.04994404f, 1.05018103f, 1.05041802f, 1.05065501f,
                1.05089211f, 1.05112922f, 1.05136645f, 1.05160367f, 1.05184102f,
                1.05207837f, 1.05231583f, 1.05255330f, 1.05279076f, 1.05302835f,
                1.05326593f, 1.05350363f, 1.05374134f, 1.05397916f, 1.05421698f,
                1.05445492f, 1.05469286f, 1.05493081f, 1.05516887f, 1.05540705f,
                1.05564523f, 1.05588341f, 1.05612171f, 1.05636001f, 1.05659842f,
                1.05683684f, 1.05707526f, 1.05731380f, 1.05755246f, 1.05779111f,
                1.05802977f, 1.05826855f, 1.05850732f, 1.05874622f, 1.05898511f,
                1.05922413f};

            const f32 Util::Decibel2RatioTable[VOLUME_TABLE_SIZE] = {
                0.0000000000f, 0.0000305492f, 0.0000309030f, 0.0000312608f, 0.0000316228f,
                0.0000319890f, 0.0000323594f, 0.0000327341f, 0.0000331131f, 0.0000334965f,
                0.0000338844f, 0.0000342768f, 0.0000346737f, 0.0000350752f, 0.0000354813f,
                0.0000358922f, 0.0000363078f, 0.0000367282f, 0.0000371535f, 0.0000375837f,
                0.0000380189f, 0.0000384592f, 0.0000389045f, 0.0000393550f, 0.0000398107f,
                0.0000402717f, 0.0000407380f, 0.0000412098f, 0.0000416869f, 0.0000421697f,
                0.0000426580f, 0.0000431519f, 0.0000436516f, 0.0000441570f, 0.0000446684f,
                0.0000451856f, 0.0000457088f, 0.0000462381f, 0.0000467735f, 0.0000473151f,
                0.0000478630f, 0.0000484172f, 0.0000489779f, 0.0000495450f, 0.0000501187f,
                0.0000506991f, 0.0000512861f, 0.0000518800f, 0.0000524807f, 0.0000530884f,
                0.0000537032f, 0.0000543250f, 0.0000549541f, 0.0000555904f, 0.0000562341f,
                0.0000568853f, 0.0000575440f, 0.0000582103f, 0.0000588844f, 0.0000595662f,
                0.0000602560f, 0.0000609537f, 0.0000616595f, 0.0000623735f, 0.0000630957f,
                0.0000638263f, 0.0000645654f, 0.0000653131f, 0.0000660693f, 0.0000668344f,
                0.0000676083f, 0.0000683912f, 0.0000691831f, 0.0000699842f, 0.0000707946f,
                0.0000716143f, 0.0000724436f, 0.0000732825f, 0.0000741310f, 0.0000749894f,
                0.0000758578f, 0.0000767361f, 0.0000776247f, 0.0000785236f, 0.0000794328f,
                0.0000803526f, 0.0000812831f, 0.0000822243f, 0.0000831764f, 0.0000841395f,
                0.0000851138f, 0.0000860994f, 0.0000870964f, 0.0000881049f, 0.0000891251f,
                0.0000901571f, 0.0000912011f, 0.0000922571f, 0.0000933254f, 0.0000944061f,
                0.0000954993f, 0.0000966051f, 0.0000977237f, 0.0000988553f, 0.0001000000f,
                0.0001011580f, 0.0001023290f, 0.0001035140f, 0.0001047130f, 0.0001059250f,
                0.0001071520f, 0.0001083930f, 0.0001096480f, 0.0001109170f, 0.0001122020f,
                0.0001135010f, 0.0001148150f, 0.0001161450f, 0.0001174900f, 0.0001188500f,
                0.0001202260f, 0.0001216190f, 0.0001230270f, 0.0001244510f, 0.0001258930f,
                0.0001273500f, 0.0001288250f, 0.0001303170f, 0.0001318260f, 0.0001333520f,
                0.0001348960f, 0.0001364580f, 0.0001380380f, 0.0001396370f, 0.0001412540f,
                0.0001428890f, 0.0001445440f, 0.0001462180f, 0.0001479110f, 0.0001496240f,
                0.0001513560f, 0.0001531090f, 0.0001548820f, 0.0001566750f, 0.0001584890f,
                0.0001603250f, 0.0001621810f, 0.0001640590f, 0.0001659590f, 0.0001678800f,
                0.0001698240f, 0.0001717910f, 0.0001737800f, 0.0001757920f, 0.0001778280f,
                0.0001798870f, 0.0001819700f, 0.0001840770f, 0.0001862090f, 0.0001883650f,
                0.0001905460f, 0.0001927520f, 0.0001949840f, 0.0001972420f, 0.0001995260f,
                0.0002018370f, 0.0002041740f, 0.0002065380f, 0.0002089300f, 0.0002113490f,
                0.0002137960f, 0.0002162720f, 0.0002187760f, 0.0002213090f, 0.0002238720f,
                0.0002264640f, 0.0002290870f, 0.0002317390f, 0.0002344230f, 0.0002371370f,
                0.0002398830f, 0.0002426610f, 0.0002454710f, 0.0002483130f, 0.0002511890f,
                0.0002540970f, 0.0002570400f, 0.0002600160f, 0.0002630270f, 0.0002660730f,
                0.0002691530f, 0.0002722700f, 0.0002754230f, 0.0002786120f, 0.0002818380f,
                0.0002851020f, 0.0002884030f, 0.0002917430f, 0.0002951210f, 0.0002985380f,
                0.0003019950f, 0.0003054920f, 0.0003090300f, 0.0003126080f, 0.0003162280f,
                0.0003198900f, 0.0003235940f, 0.0003273410f, 0.0003311310f, 0.0003349650f,
                0.0003388440f, 0.0003427680f, 0.0003467370f, 0.0003507520f, 0.0003548130f,
                0.0003589220f, 0.0003630780f, 0.0003672820f, 0.0003715350f, 0.0003758370f,
                0.0003801890f, 0.0003845920f, 0.0003890450f, 0.0003935500f, 0.0003981070f,
                0.0004027170f, 0.0004073800f, 0.0004120980f, 0.0004168690f, 0.0004216970f,
                0.0004265800f, 0.0004315190f, 0.0004365160f, 0.0004415700f, 0.0004466840f,
                0.0004518560f, 0.0004570880f, 0.0004623810f, 0.0004677350f, 0.0004731510f,
                0.0004786300f, 0.0004841720f, 0.0004897790f, 0.0004954500f, 0.0005011870f,
                0.0005069910f, 0.0005128610f, 0.0005188000f, 0.0005248070f, 0.0005308840f,
                0.0005370320f, 0.0005432500f, 0.0005495410f, 0.0005559040f, 0.0005623410f,
                0.0005688530f, 0.0005754400f, 0.0005821030f, 0.0005888440f, 0.0005956620f,
                0.0006025600f, 0.0006095370f, 0.0006165950f, 0.0006237350f, 0.0006309570f,
                0.0006382630f, 0.0006456540f, 0.0006531310f, 0.0006606930f, 0.0006683440f,
                0.0006760830f, 0.0006839120f, 0.0006918310f, 0.0006998420f, 0.0007079460f,
                0.0007161430f, 0.0007244360f, 0.0007328250f, 0.0007413100f, 0.0007498940f,
                0.0007585780f, 0.0007673610f, 0.0007762470f, 0.0007852360f, 0.0007943280f,
                0.0008035260f, 0.0008128310f, 0.0008222430f, 0.0008317640f, 0.0008413950f,
                0.0008511380f, 0.0008609940f, 0.0008709640f, 0.0008810490f, 0.0008912510f,
                0.0009015710f, 0.0009120110f, 0.0009225710f, 0.0009332540f, 0.0009440610f,
                0.0009549930f, 0.0009660510f, 0.0009772370f, 0.0009885530f, 0.0010000000f,
                0.0010115789f, 0.0010232930f, 0.0010351420f, 0.0010471290f, 0.0010592540f,
                0.0010715190f, 0.0010839270f, 0.0010964780f, 0.0011091750f, 0.0011220180f,
                0.0011350110f, 0.0011481540f, 0.0011614490f, 0.0011748980f, 0.0011885019f,
                0.0012022640f, 0.0012161860f, 0.0012302690f, 0.0012445149f, 0.0012589250f,
                0.0012735029f, 0.0012882500f, 0.0013031670f, 0.0013182570f, 0.0013335210f,
                0.0013489630f, 0.0013645830f, 0.0013803840f, 0.0013963680f, 0.0014125380f,
                0.0014288940f, 0.0014454400f, 0.0014621770f, 0.0014791080f, 0.0014962360f,
                0.0015135610f, 0.0015310870f, 0.0015488170f, 0.0015667510f, 0.0015848930f,
                0.0016032450f, 0.0016218100f, 0.0016405900f, 0.0016595870f, 0.0016788041f,
                0.0016982440f, 0.0017179080f, 0.0017378010f, 0.0017579240f, 0.0017782790f,
                0.0017988710f, 0.0018197011f, 0.0018407720f, 0.0018620871f, 0.0018836490f,
                0.0019054610f, 0.0019275250f, 0.0019498450f, 0.0019724229f, 0.0019952620f,
                0.0020183660f, 0.0020417380f, 0.0020653801f, 0.0020892960f, 0.0021134890f,
                0.0021379620f, 0.0021627189f, 0.0021877619f, 0.0022130951f, 0.0022387209f,
                0.0022646440f, 0.0022908680f, 0.0023173951f, 0.0023442290f, 0.0023713741f,
                0.0023988329f, 0.0024266101f, 0.0024547090f, 0.0024831330f, 0.0025118859f,
                0.0025409730f, 0.0025703961f, 0.0026001600f, 0.0026302680f, 0.0026607250f,
                0.0026915350f, 0.0027227011f, 0.0027542289f, 0.0027861211f, 0.0028183830f,
                0.0028510180f, 0.0028840320f, 0.0029174271f, 0.0029512090f, 0.0029853829f,
                0.0030199520f, 0.0030549210f, 0.0030902950f, 0.0031260790f, 0.0031622781f,
                0.0031988949f, 0.0032359371f, 0.0032734070f, 0.0033113109f, 0.0033496539f,
                0.0033884421f, 0.0034276780f, 0.0034673689f, 0.0035075189f, 0.0035481339f,
                0.0035892189f, 0.0036307811f, 0.0036728231f, 0.0037153519f, 0.0037583739f,
                0.0038018939f, 0.0038459180f, 0.0038904510f, 0.0039355010f, 0.0039810720f,
                0.0040271701f, 0.0040738028f, 0.0041209748f, 0.0041686939f, 0.0042169648f,
                0.0042657950f, 0.0043151909f, 0.0043651578f, 0.0044157039f, 0.0044668359f,
                0.0045185592f, 0.0045708818f, 0.0046238098f, 0.0046773511f, 0.0047315131f,
                0.0047863009f, 0.0048417239f, 0.0048977882f, 0.0049545020f, 0.0050118719f,
                0.0050699068f, 0.0051286141f, 0.0051879999f, 0.0052480749f, 0.0053088441f,
                0.0053703180f, 0.0054325028f, 0.0054954090f, 0.0055590430f, 0.0056234128f,
                0.0056885290f, 0.0057543991f, 0.0058210320f, 0.0058884369f, 0.0059566209f,
                0.0060255961f, 0.0060953689f, 0.0061659501f, 0.0062373481f, 0.0063095731f,
                0.0063826349f, 0.0064565418f, 0.0065313061f, 0.0066069341f, 0.0066834390f,
                0.0067608301f, 0.0068391161f, 0.0069183102f, 0.0069984202f, 0.0070794579f,
                0.0071614338f, 0.0072443602f, 0.0073282449f, 0.0074131018f, 0.0074989418f,
                0.0075857760f, 0.0076736151f, 0.0077624712f, 0.0078523559f, 0.0079432819f,
                0.0080352612f, 0.0081283050f, 0.0082224263f, 0.0083176382f, 0.0084139509f,
                0.0085113803f, 0.0086099384f, 0.0087096356f, 0.0088104894f, 0.0089125093f,
                0.0090157110f, 0.0091201076f, 0.0092257140f, 0.0093325432f, 0.0094406093f,
                0.0095499260f, 0.0096605094f, 0.0097723724f, 0.0098855309f, 0.0099999998f,
                0.0101157948f, 0.0102329301f, 0.0103514222f, 0.0104712853f, 0.0105925370f,
                0.0107151931f, 0.0108392686f, 0.0109647820f, 0.0110917483f, 0.0112201851f,
                0.0113501083f, 0.0114815356f, 0.0116144856f, 0.0117489761f, 0.0118850218f,
                0.0120226443f, 0.0121618602f, 0.0123026883f, 0.0124451462f, 0.0125892544f,
                0.0127350306f, 0.0128824962f, 0.0130316680f, 0.0131825674f, 0.0133352140f,
                0.0134896291f, 0.0136458306f, 0.0138038434f, 0.0139636844f, 0.0141253751f,
                0.0142889395f, 0.0144543983f, 0.0146217719f, 0.0147910845f, 0.0149623565f,
                0.0151356123f, 0.0153108751f, 0.0154881664f, 0.0156675112f, 0.0158489328f,
                0.0160324536f, 0.0162181016f, 0.0164058972f, 0.0165958684f, 0.0167880394f,
                0.0169824362f, 0.0171790831f, 0.0173780080f, 0.0175792351f, 0.0177827943f,
                0.0179887097f, 0.0181970093f, 0.0184077192f, 0.0186208710f, 0.0188364908f,
                0.0190546066f, 0.0192752499f, 0.0194984451f, 0.0197242275f, 0.0199526232f,
                0.0201836638f, 0.0204173792f, 0.0206538029f, 0.0208929610f, 0.0211348906f,
                0.0213796217f, 0.0216271859f, 0.0218776166f, 0.0221309476f, 0.0223872103f,
                0.0226464439f, 0.0229086764f, 0.0231739469f, 0.0234422889f, 0.0237137377f,
                0.0239883289f, 0.0242661014f, 0.0245470889f, 0.0248313304f, 0.0251188632f,
                0.0254097264f, 0.0257039573f, 0.0260015968f, 0.0263026804f, 0.0266072508f,
                0.0269153472f, 0.0272270124f, 0.0275422875f, 0.0278612114f, 0.0281838290f,
                0.0285101831f, 0.0288403146f, 0.0291742701f, 0.0295120925f, 0.0298538264f,
                0.0301995166f, 0.0305492114f, 0.0309029538f, 0.0312607922f, 0.0316227786f,
                0.0319889523f, 0.0323593654f, 0.0327340700f, 0.0331131108f, 0.0334965438f,
                0.0338844173f, 0.0342767797f, 0.0346736833f, 0.0350751877f, 0.0354813375f,
                0.0358921923f, 0.0363078043f, 0.0367282294f, 0.0371535234f, 0.0375837386f,
                0.0380189382f, 0.0384591781f, 0.0389045142f, 0.0393550098f, 0.0398107171f,
                0.0402717032f, 0.0407380275f, 0.0412097536f, 0.0416869372f, 0.0421696492f,
                0.0426579528f, 0.0431519076f, 0.0436515845f, 0.0441570468f, 0.0446683578f,
                0.0451855958f, 0.0457088202f, 0.0462381020f, 0.0467735156f, 0.0473151244f,
                0.0478630103f, 0.0484172367f, 0.0489778817f, 0.0495450199f, 0.0501187220f,
                0.0506990701f, 0.0512861386f, 0.0518800057f, 0.0524807461f, 0.0530884452f,
                0.0537031814f, 0.0543250330f, 0.0549540855f, 0.0555904247f, 0.0562341325f,
                0.0568852946f, 0.0575439930f, 0.0582103208f, 0.0588843673f, 0.0595662147f,
                0.0602559596f, 0.0609536916f, 0.0616595000f, 0.0623734854f, 0.0630957335f,
                0.0638263524f, 0.0645654202f, 0.0653130561f, 0.0660693422f, 0.0668343902f,
                0.0676082969f, 0.0683911666f, 0.0691830963f, 0.0699841976f, 0.0707945749f,
                0.0716143399f, 0.0724435970f, 0.0732824504f, 0.0741310269f, 0.0749894232f,
                0.0758577585f, 0.0767361522f, 0.0776247084f, 0.0785235614f, 0.0794328228f,
                0.0803526118f, 0.0812830552f, 0.0822242647f, 0.0831763744f, 0.0841395110f,
                0.0851138011f, 0.0860993713f, 0.0870963559f, 0.0881048888f, 0.0891250968f,
                0.0901571140f, 0.0912010819f, 0.0922571421f, 0.0933254287f, 0.0944060907f,
                0.0954992622f, 0.0966050848f, 0.0977237225f, 0.0988553092f, 0.1000000015f,
                0.1011579484f, 0.1023292989f, 0.1035142168f, 0.1047128513f, 0.1059253737f,
                0.1071519330f, 0.1083926931f, 0.1096478179f, 0.1109174788f, 0.1122018471f,
                0.1135010794f, 0.1148153618f, 0.1161448583f, 0.1174897552f, 0.1188502237f,
                0.1202264428f, 0.1216185987f, 0.1230268776f, 0.1244514585f, 0.1258925349f,
                0.1273503006f, 0.1288249493f, 0.1303166747f, 0.1318256706f, 0.1333521456f,
                0.1348962933f, 0.1364583075f, 0.1380384266f, 0.1396368295f, 0.1412537545f,
                0.1428893954f, 0.1445439756f, 0.1462177187f, 0.1479108334f, 0.1496235728f,
                0.1513561308f, 0.1531087458f, 0.1548816562f, 0.1566751003f, 0.1584893167f,
                0.1603245437f, 0.1621810049f, 0.1640589833f, 0.1659586877f, 0.1678804010f,
                0.1698243618f, 0.1717908382f, 0.1737800837f, 0.1757923663f, 0.1778279394f,
                0.1798870862f, 0.1819700897f, 0.1840772033f, 0.1862087101f, 0.1883649081f,
                0.1905460656f, 0.1927524954f, 0.1949844658f, 0.1972422749f, 0.1995262355f,
                0.2018366307f, 0.2041737884f, 0.2065380216f, 0.2089296132f, 0.2113489062f,
                0.2137962133f, 0.2162718475f, 0.2187761664f, 0.2213094682f, 0.2238721102f,
                0.2264644355f, 0.2290867716f, 0.2317394614f, 0.2344228774f, 0.2371373773f,
                0.2398832887f, 0.2426610142f, 0.2454708964f, 0.2483133078f, 0.2511886358f,
                0.2540972829f, 0.2570395768f, 0.2600159645f, 0.2630268037f, 0.2660725117f,
                0.2691534758f, 0.2722701430f, 0.2754228711f, 0.2786121070f, 0.2818382978f,
                0.2851018310f, 0.2884031534f, 0.2917427123f, 0.2951209247f, 0.2985382676f,
                0.3019951582f, 0.3054921031f, 0.3090295494f, 0.3126079440f, 0.3162277639f,
                0.3198895156f, 0.3235936463f, 0.3273406923f, 0.3311311305f, 0.3349654377f,
                0.3388441503f, 0.3427677751f, 0.3467368484f, 0.3507518768f, 0.3548133969f,
                0.3589219451f, 0.3630780578f, 0.3672823012f, 0.3715352416f, 0.3758374155f,
                0.3801893890f, 0.3845917881f, 0.3890451491f, 0.3935500681f, 0.3981071711f,
                0.4027170241f, 0.4073802829f, 0.4120975137f, 0.4168693721f, 0.4216965139f,
                0.4265795052f, 0.4315190911f, 0.4365158379f, 0.4415704608f, 0.4466835856f,
                0.4518559575f, 0.4570882022f, 0.4623810351f, 0.4677351415f, 0.4731512666f,
                0.4786300957f, 0.4841723740f, 0.4897788167f, 0.4954501987f, 0.5011872053f,
                0.5069907308f, 0.5128613710f, 0.5188000202f, 0.5248074532f, 0.5308844447f,
                0.5370317698f, 0.5432503223f, 0.5495408773f, 0.5559042692f, 0.5623413324f,
                0.5688529015f, 0.5754399300f, 0.5821031928f, 0.5888436437f, 0.5956621170f,
                0.6025595665f, 0.6095368862f, 0.6165950298f, 0.6237348318f, 0.6309573650f,
                0.6382634640f, 0.6456542015f, 0.6531305313f, 0.6606934667f, 0.6683439016f,
                0.6760829687f, 0.6839116216f, 0.6918309927f, 0.6998419762f, 0.7079457641f,
                0.7161434293f, 0.7244359851f, 0.7328245044f, 0.7413102388f, 0.7498942018f,
                0.7585775852f, 0.7673614621f, 0.7762471437f, 0.7852356434f, 0.7943282127f,
                0.8035261035f, 0.8128305078f, 0.8222426772f, 0.8317637444f, 0.8413951397f,
                0.8511380553f, 0.8609937429f, 0.8709635735f, 0.8810488582f, 0.8912509084f,
                0.9015711546f, 0.9120108485f, 0.9225714207f, 0.9332543015f, 0.9440608621f,
                0.9549925923f, 0.9660508633f, 0.9772372246f, 0.9885531068f, 1.0000000000f,
                1.0115795135f, 1.0232930183f, 1.0351421833f, 1.0471285582f, 1.0592536926f,
                1.0715192556f, 1.0839269161f, 1.0964782238f, 1.1091748476f, 1.1220184565f,
                1.1350108385f, 1.1481536627f, 1.1614485979f, 1.1748975515f, 1.1885021925f,
                1.2022644281f, 1.2161860466f, 1.2302687168f, 1.2445145845f, 1.2589254379f,
                1.2735030651f, 1.2882494926f, 1.3031667471f, 1.3182567358f, 1.3335214853f,
                1.3489629030f, 1.3645831347f, 1.3803842068f, 1.3963683844f, 1.4125375748f,
                1.4288939238f, 1.4454398155f, 1.4621771574f, 1.4791083336f, 1.4962356091f,
                1.5135612488f, 1.5310875177f, 1.5488165617f, 1.5667511225f, 1.5848932266f,
                1.6032453775f, 1.6218100786f, 1.6405897141f, 1.6595869064f, 1.6788040400f,
                1.6982436180f, 1.7179083824f, 1.7378008366f, 1.7579236031f, 1.7782794237f,
                1.7988709211f, 1.8197008371f, 1.8407720327f, 1.8620871305f, 1.8836491108f,
                1.9054607153f, 1.9275249243f, 1.9498445988f, 1.9724227190f, 1.9952622652f};

            const f32 Util::Pan2RatioTable[PAN_TABLE_SIZE] = {
                1.0000000000f, 0.9980449677f, 0.9960861206f, 0.9941233397f, 0.9921567440f,
                0.9901862144f, 0.9882117510f, 0.9862333536f, 0.9842509627f, 0.9822645783f,
                0.9802742004f, 0.9782797694f, 0.9762812257f, 0.9742785692f, 0.9722718000f,
                0.9702609181f, 0.9682458639f, 0.9662265778f, 0.9642030597f, 0.9621752501f,
                0.9601432085f, 0.9581068754f, 0.9560661316f, 0.9540210962f, 0.9519716501f,
                0.9499177337f, 0.9478594065f, 0.9457966089f, 0.9437292814f, 0.9416574240f,
                0.9395810366f, 0.9375000000f, 0.9354143739f, 0.9333240390f, 0.9312290549f,
                0.9291293025f, 0.9270247817f, 0.9249155521f, 0.9228014350f, 0.9206824899f,
                0.9185586572f, 0.9164298773f, 0.9142961502f, 0.9121574759f, 0.9100137353f,
                0.9078649282f, 0.9057110548f, 0.9035519958f, 0.9013878107f, 0.8992184401f,
                0.8970437646f, 0.8948638439f, 0.8926785588f, 0.8904879093f, 0.8882918954f,
                0.8860904574f, 0.8838834763f, 0.8816710114f, 0.8794529438f, 0.8772292733f,
                0.8750000000f, 0.8727650046f, 0.8705242872f, 0.8682777286f, 0.8660253882f,
                0.8637672067f, 0.8615030646f, 0.8592329621f, 0.8569568396f, 0.8546746373f,
                0.8523863554f, 0.8500919342f, 0.8477912545f, 0.8454843163f, 0.8431711197f,
                0.8408514857f, 0.8385254741f, 0.8361930251f, 0.8338540196f, 0.8315083981f,
                0.8291562200f, 0.8267973065f, 0.8244315982f, 0.8220591545f, 0.8196797967f,
                0.8172935247f, 0.8149002790f, 0.8125000000f, 0.8100925684f, 0.8076779842f,
                0.8052561879f, 0.8028270602f, 0.8003905416f, 0.7979465723f, 0.7954951525f,
                0.7930361032f, 0.7905694246f, 0.7880949974f, 0.7856128216f, 0.7831227779f,
                0.7806247473f, 0.7781187296f, 0.7756046057f, 0.7730823159f, 0.7705517411f,
                0.7680128813f, 0.7654655576f, 0.7629097104f, 0.7603453398f, 0.7577722073f,
                0.7551903725f, 0.7525996566f, 0.7500000000f, 0.7473912835f, 0.7447734475f,
                0.7421463728f, 0.7395099998f, 0.7368641496f, 0.7342087626f, 0.7315437198f,
                0.7288689613f, 0.7261843681f, 0.7234898210f, 0.7207851410f, 0.7180703282f,
                0.7153452039f, 0.7126096487f, 0.7098635435f, 0.7071067691f, 0.7043392062f,
                0.7015607357f, 0.6987712383f, 0.6959705353f, 0.6931585073f, 0.6903350353f,
                0.6875000000f, 0.6846532226f, 0.6817945242f, 0.6789237857f, 0.6760408878f,
                0.6731455922f, 0.6702378392f, 0.6673173904f, 0.6643841267f, 0.6614378095f,
                0.6584783792f, 0.6555055380f, 0.6525191665f, 0.6495190263f, 0.6465049982f,
                0.6434769034f, 0.6404344440f, 0.6373774409f, 0.6343057156f, 0.6312190294f,
                0.6281172037f, 0.6250000000f, 0.6218671203f, 0.6187184453f, 0.6155536175f,
                0.6123724580f, 0.6091746688f, 0.6059600115f, 0.6027281880f, 0.5994789600f,
                0.5962120295f, 0.5929270387f, 0.5896238089f, 0.5863019824f, 0.5829612017f,
                0.5796011686f, 0.5762215257f, 0.5728219748f, 0.5694020987f, 0.5659615993f,
                0.5625000000f, 0.5590170026f, 0.5555121303f, 0.5519850254f, 0.5484352708f,
                0.5448623896f, 0.5412659049f, 0.5376453400f, 0.5340002179f, 0.5303300619f,
                0.5266343355f, 0.5229125023f, 0.5191639662f, 0.5153881907f, 0.5115845203f,
                0.5077524185f, 0.5038911104f, 0.5000000000f, 0.4960783720f, 0.4921254814f,
                0.4881406128f, 0.4841229320f, 0.4800716043f, 0.4759858251f, 0.4718646407f,
                0.4677071869f, 0.4635123909f, 0.4592793286f, 0.4550068676f, 0.4506939054f,
                0.4463392794f, 0.4419417381f, 0.4375000000f, 0.4330126941f, 0.4284784198f,
                0.4238956273f, 0.4192627370f, 0.4145781100f, 0.4098398983f, 0.4050462842f,
                0.4001952708f, 0.3952847123f, 0.3903123736f, 0.3852758706f, 0.3801726699f,
                0.3750000000f, 0.3697549999f, 0.3644344807f, 0.3590351641f, 0.3535533845f,
                0.3479852676f, 0.3423266113f, 0.3365727961f, 0.3307189047f, 0.3247595131f,
                0.3186887205f, 0.3125000000f, 0.3061862290f, 0.2997394800f, 0.2931509912f,
                0.2864109874f, 0.2795085013f, 0.2724311948f, 0.2651650310f, 0.2576940954f,
                0.2500000000f, 0.2420614660f, 0.2338535935f, 0.2253469527f, 0.2165063471f,
                0.2072890550f, 0.1976423562f, 0.1875000000f, 0.1767766923f, 0.1653594524f,
                0.1530931145f, 0.1397542506f, 0.1250000000f, 0.1082531735f, 0.0883883461f,
                0.0625000000f, 0.0000000000f
            };
        }
    }
}
